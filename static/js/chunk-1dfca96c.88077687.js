(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1dfca96c"],{"028b":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-layout",{class:["admin-layout","beauty-scroll"]},[a("a-layout",{staticClass:"admin-layout-main beauty-scroll"},[a("project-header",{class:[{"fixed-tabs":e.fixedTabs,"fixed-header":e.fixedHeader,"multi-page":e.multiPage}],style:e.headerStyle,attrs:{menuData:e.headMenuData}}),a("a-layout-content",{staticClass:"admin-layout-content",staticStyle:{"min-height":"100vh",margin:"10px 0px 20px 15px"}},[a("div",{staticStyle:{position:"relative"}},[e._t("default")],2)]),a("a-layout-footer",{staticStyle:{padding:"0px"}},[a("page-footer",{attrs:{"link-list":e.footerLinks,copyright:e.copyright,version:e.systemVersion}})],1)],1)],1)},n=[],r=a("b85c"),s=a("5530"),o=(a("99af"),a("fb6a"),a("c740"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-layout-header",{class:[e.headerTheme,"admin-header"]},[i("div",{class:["admin-header-wide",e.layout,e.pageWidth]},[i("router-link",{class:["logo",e.isMobile?null:"pc",e.headerTheme],attrs:{to:"/"}},[i("img",{attrs:{width:"32",src:a("9d64")}}),i("h1",[e._v(e._s(e.systemName))])]),e.isMobile?i("a-divider",{attrs:{type:"vertical"}}):e._e(),"side"===e.layout||e.isMobile?e._e():i("div",{staticClass:"admin-header-menu",style:"width: "+e.menuWidth+";"},[i("i-menu",{staticClass:"head-menu",attrs:{theme:e.headerTheme,mode:"horizontal",options:e.menuData},on:{select:e.onSelect}})],1),i("div",{class:["admin-header-right",e.headerTheme]},[i("header-avatar",{staticClass:"header-item"}),i("a-dropdown",{staticClass:"lang header-item"},[i("div",[i("a-icon",{attrs:{type:"global"}}),e._v(" "+e._s(e.langAlias)+" ")],1),i("a-menu",{attrs:{slot:"overlay","selected-keys":[e.lang]},on:{click:function(t){return e.setLang(t.key)}},slot:"overlay"},e._l(e.langList,(function(t){return i("a-menu-item",{key:t.key},[e._v(" "+e._s(t.name))])})),1)],1)],1)],1)])}),c=[],l=(a("7db0"),a("d3b7"),a("2b49")),u=a("301a"),d=a("2f62"),m=a("cf45"),h={name:"ProjectHeader",components:{IMenu:u["a"],HeaderAvatar:l["a"]},props:["collapsed","menuData"],i18n:a("89fe"),data:function(){return{searchActive:!1}},created:function(){var e=this,t=this.$createElement,a=this;this.$EventBus.$off("RealAlarm"),this.$EventBus.$on("RealAlarm",(function(i){var n=i,r="",s="",o="",c="#0099FF",l="",u=a.formatDateTime(n.HappenTime);"1"==n.Value?(r=a.$t("monitor.Notification.MessageAlarmTitle"),s=e.$t(n.AlarmMessage),l=a.$t("alarm.Speech.tips")):(r=a.$t("monitor.Notification.MessageClearAlarmTitle"),s=e.$t(n.AlarmClearMessage)),"videoConnectStatusAlarm"==n.DataUuid&&(n.AlarmLevel=3,n.DataName=a.$t("monitor.Notification.public.videoDataName"),s="1"==n.Value?a.$t("monitor.Notification.public.videoOffline"):a.$t("monitor.Notification.public.videoOnline")),0==n.AlarmLevel?(c="#0099FF",o=a.$t("dataModel.alarm.Tips")):1==n.AlarmLevel?(c="#0066FF",o=a.$t("dataModel.alarm.Minor")):2==n.AlarmLevel?(c="yellow",o=a.$t("dataModel.alarm.Importance")):3==n.AlarmLevel?(c="orange",o=a.$t("dataModel.alarm.Urgency")):4==n.AlarmLevel&&(c="red",o=a.$t("dataModel.alarm.Deadly")),l+=a.$t("monitor.Notification.DeviceTitle"),l+=a.$t(n.DeviceName),l+=a.$t("monitor.Notification.DataTitle"),l+=a.$t(n.DataName),l+=a.$t("dataModel.AlarmLevel"),l+=o,l+=a.$t("monitor.Notification.HappenTime"),l+=u,l+=a.$t("monitor.Notification.Message"),l+=s,a.$notification.warning({message:t("a-tag",{style:{backgroundColor:c}},[r]),description:t("div",[t("span",{style:"font-size: 14px;font-weight: bold;"},[a.$t("monitor.Notification.DeviceTitle"),":"]),t("span",[a.$t(n.DeviceName)]),t("br"),t("span",{style:"font-size: 14px;font-weight: bold;"},[a.$t("monitor.Notification.DataTitle"),":"]),t("span",[a.$t(n.DataName)]),t("br"),t("span",{style:"font-size: 14px;font-weight: bold;"},[a.$t("dataModel.AlarmLevel"),":"]),t("span",[t("a-tag",{style:{backgroundColor:c}},[o])]),t("br"),t("span",{style:"font-size: 14px;font-weight: bold;"},[a.$t("monitor.Notification.HappenTime"),":"]),t("span",[u]),t("br"),t("span",{style:"font-size: 14px;font-weight: bold;"},[a.$t("monitor.Notification.Message"),":"]),t("span",[s]),t("br")]),placement:"bottomRight",duration:30,icon:t("a-icon",{attrs:{type:"alert",theme:"filled"},style:{position:"absolute","margin-left":"4px","font-size":"24px","line-height":"24px",color:"red"}}),style:{padding:"10px 5px"}}),a.alarmSoundSpeech().start({container:"#sppekContent",Lang:a.$i18n.locale,rate:1},l)}))},computed:Object(s["a"])(Object(s["a"])({},Object(d["e"])("setting",["langList","theme","isMobile","layout","systemName","lang","pageWidth"])),{},{headerTheme:function(){return"side"!=this.layout||"dark"!=this.theme.mode||this.isMobile?this.theme.mode:"light"},langAlias:function(){var e=this,t=this.langList.find((function(t){return t.key==e.lang}));return t.alias},menuWidth:function(){var e=this.layout,t=this.searchActive,a="head"===e?"100% - 188px":"100%",i=t?"600px":"400px";return"calc(".concat(a," - ").concat(i,")")}}),methods:Object(s["a"])({formatDateTime:function(e){var t=new Date(e);return Object(m["a"])(t,"yyyy-MM-dd hh:mm:ss")},toggleCollapse:function(){this.$emit("toggleCollapse")},onSelect:function(e){this.$emit("menuSelect",e)}},Object(d["d"])("setting",["setLang"]))},b=h,p=(a("a2eb"),a("2877")),f=Object(p["a"])(b,o,c,!1,null,"66a0c5d4",null),g=f.exports,D=a("613e"),y=(a("a41c"),a("e5f9"),a("060e"),{name:"ProjectLayout",components:{PageFooter:D["a"],ProjectHeader:g},data:function(){return{minHeight:window.innerHeight-64-122,collapsed:!1,showSetting:!1,drawerOpen:!1}},provide:function(){return{adminLayout:this}},watch:{$route:function(e){this.setActivated(e)},layout:function(){this.setActivated(this.$route)},isMobile:function(e){e||(this.drawerOpen=!1)}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(d["e"])("setting",["isMobile","theme","layout","footerLinks","copyright","fixedHeader","fixedSideBar","fixedTabs","hideSetting","multiPage","systemVersion"])),Object(d["c"])("setting",["firstMenu","subMenu","menuData"])),{},{sideMenuWidth:function(){return this.collapsed?"80px":"256px"},headerStyle:function(){var e=this.fixedHeader&&"head"!==this.layout&&!this.isMobile?"calc(100% - ".concat(this.sideMenuWidth,")"):"100%",t=this.fixedHeader?"fixed":"static";return"width: ".concat(e,"; position: ").concat(t,";")},headMenuData:function(){var e=this.layout,t=this.menuData,a=this.firstMenu;return"mix"===e?a:t},sideMenuData:function(){var e=this.layout,t=this.menuData,a=this.subMenu;return"mix"===e?a:t}}),methods:Object(s["a"])(Object(s["a"])({},Object(d["d"])("setting",["correctPageMinHeight","setActivatedFirst"])),{},{toggleCollapse:function(){this.collapsed=!this.collapsed},onMenuSelect:function(){this.toggleCollapse()},setActivated:function(e){var t=this;if("mix"===this.layout){var a=e.matched;a=a.slice(0,a.length-1);var i,n=this.firstMenu,s=Object(r["a"])(n);try{var o=function(){var e=i.value;if(-1!==a.findIndex((function(t){return t.path===e.fullPath})))return t.setActivatedFirst(e.fullPath),"break"};for(s.s();!(i=s.n()).done;){var c=o();if("break"===c)break}}catch(l){s.e(l)}finally{s.f()}}}}),created:function(){this.correctPageMinHeight(this.minHeight-24),this.setActivated(this.$route)},beforeDestroy:function(){this.correctPageMinHeight(24-this.minHeight)}}),v=y,k=(a("6959"),Object(p["a"])(v,i,n,!1,null,"17a11d2e",null));t["a"]=k.exports},"0578":function(e,t,a){"use strict";a("6a11")},5092:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-header-index-wide"},[a("a-card",{style:{height:"100%"},attrs:{bordered:!1,bodyStyle:{padding:"16px",height:"100%"}}},[a("a-tabs",{attrs:{"default-active-key":"3"},on:{change:e.callback}},[a("a-tab-pane",{key:"3",attrs:{tab:e.$t("DbBack.DbConfig")}},[a("a-spin",{attrs:{tip:e.$t("DbBack.Loading"),spinning:e.messageShowLoad}},[a("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:12}}},[a("a-form-item",{attrs:{label:e.$t("DbBack.DbType")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["DbType",{rules:[{required:!0,message:e.$t("DbBack.DbType")}]}],expression:"['DbType', { rules: [{ required: true, message: $t('DbBack.DbType') }] }]"}],on:{select:e.chargeDb}},[a("a-select-option",{attrs:{value:"1"}},[e._v(" Sqlite3 ")]),a("a-select-option",{attrs:{value:"0"}},[e._v(" Mysql ")])],1)],1),0==e.DbType?a("div",[a("a-form-item",{attrs:{label:e.$t("DbBack.DbServer")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["DbServer",{rules:[{required:!0,message:e.$t("DbBack.DbServer")}]}],expression:"['DbServer', { rules: [{ required: true, message: $t('DbBack.DbServer') }] }]"}]})],1),a("a-form-item",{attrs:{label:e.$t("DbBack.DbServerPort")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["DbServerPort",{rules:[{required:!0,message:e.$t("DbBack.DbServerPort")}]}],expression:"['DbServerPort', { rules: [{ required: true, message: $t('DbBack.DbServerPort') }] }]"}]})],1),a("a-form-item",{attrs:{label:e.$t("DbBack.DbName")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["DbName",{rules:[{required:!0,message:e.$t("DbBack.DbName")}]}],expression:"['DbName', { rules: [{ required: true, message: $t('DbBack.DbName') }] }]"}]})],1),a("a-form-item",{attrs:{label:e.$t("DbBack.DbUserName")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["DbUserName",{rules:[{required:!0,message:e.$t("DbBack.DbUserName")}]}],expression:"['DbUserName', { rules: [{ required: true, message: $t('DbBack.DbUserName') }] }]"}]})],1),a("a-form-item",{attrs:{label:e.$t("DbBack.DbPassword")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["DbPassword",{rules:[{required:!0,message:e.$t("DbBack.DbPassword")}]}],expression:"['DbPassword', { rules: [{ required: true, message: $t('DbBack.DbPassword') }] }]"}]})],1)],1):e._e(),a("a-form-item",{attrs:{"wrapper-col":{span:12,offset:5}}},[a("a-button",{attrs:{type:"primary","html-type":"submit",loading:e.Configuring},on:{click:e.SetDbConfig}},[e._v(" "+e._s(e.$t("DbBack.Sure"))+" ")])],1)],1)],1)],1),a("a-tab-pane",{key:"1",attrs:{tab:e.$t("DbBack.Backups")}},[a("a-spin",{attrs:{tip:e.$t("DbBack.BackingUp"),spinning:e.messageShowLoad}},[a("a-checkbox-group",{staticStyle:{"margin-bottom":"10px"},on:{change:e.onChange},model:{value:e.GetTables,callback:function(t){e.GetTables=t},expression:"GetTables"}},[a("a-row",e._l(e.SystemTables,(function(t,i){return a("a-col",{key:i,attrs:{span:8}},[a("a-checkbox",{attrs:{value:t}},[a("span",{staticStyle:{"font-size":"20px","font-weight":"400"}},[e._v(e._s(t))])])],1)})),1)],1),a("a-button",{attrs:{type:"default",loading:e.messageShowLoad},on:{click:e.BackUp}},[e._v(" "+e._s(e.$t("DbBack.Backups"))+" ")]),a("a-checkbox",{staticStyle:{"margin-left":"20px"},attrs:{indeterminate:e.indeterminate,checked:e.checkAll},on:{change:e.onCheckAllChange}},[e._v(" "+e._s(e.$t("DbBack.CheckAll"))+" ")])],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:e.$t("DbBack.Restore")}},[a("a-spin",{attrs:{tip:e.$t("DbBack.Restoring"),spinning:e.messageShowLoad}},[a("a-table",{attrs:{rowKey:"FileName",pagination:e.pagination,columns:e.columns,"data-source":e.BackupList},scopedSlots:e._u([{key:"Opt",fn:function(t,i){return a("div",{},[a("a",{staticStyle:{cursor:"pointer",color:"#13C2C2"},attrs:{type:"link"},on:{click:function(t){return e.DbRestore(i.FilePath)}}},[a("a-icon",{attrs:{type:"reload"}}),a("span",{staticStyle:{"margin-left":"2px"}},[e._v(e._s(e.$t("DbBack.Restore")))])],1)])}}])},[e._l(e.columns,(function(t,i){return a("template",{slot:t.slotName},[a("span",{key:i},[e._v(e._s(e.$t(t.slotName)))])])}))],2)],1)],1)],1)],1)],1)},n=[],r=(a("d3b7"),a("25f0"),a("028b"),a("1da1")),s=(a("96cf"),a("7424")),o=a("b775");function c(e){return l.apply(this,arguments)}function l(){return l=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["g"])(s["DBBACKUP"],o["b"].POST,t,{timeout:6e5}));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return d=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["g"])(s["GETTABLESLIST"],o["b"].POST,t,{timeout:6e5}));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return h=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["g"])(s["GETBACKUPLIST"],o["b"].POST,t,{timeout:6e5}));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function b(e){return p.apply(this,arguments)}function p(){return p=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["g"])(s["DBRESTORE"],o["b"].POST,t,{timeout:36e5}));case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["g"])(s["GETDBCONFIG"],o["b"].POST,t,{timeout:6e5}));case 1:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function D(e){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["g"])(s["SETDBCONFIG"],o["b"].POST,t,{timeout:6e5}));case 1:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}var v={i18n:a("89fe"),data:function(){return{checkAll:!0,messageShowLoad:!1,indeterminate:!1,SystemTables:[],DbType:"1",DbConfig:{},GetTables:[],Configuring:!1,form:this.$form.createForm(this),BackupList:[],pagination:{pageSize:15,showSizeChanger:!0},columns:[{width:"20%",slotName:"DbBack.Name",scopedSlots:{customRender:"FileName",title:"DbBack.Name"},dataIndex:"FileName"},{slotName:"DbBack.BackUpTime",width:"20%",scopedSlots:{customRender:"CreateTime",title:"DbBack.BackUpTime"},dataIndex:"CreateTime"},{slotName:"DbBack.FileSize",width:"20%",scopedSlots:{customRender:"FileSize",title:"DbBack.FileSize"},dataIndex:"FileSize"},{slotName:"configComponent.video.TableVideoOpt",width:"10%",scopedSlots:{customRender:"Opt",title:"configComponent.video.TableVideoOpt"}}]}},components:{},mounted:function(){this.GetDbConfig()},methods:{chargeDb:function(e){this.DbType=e},onCheckAllChange:function(e){Object.assign(this,{GetTables:e.target.checked?this.SystemTables:[],indeterminate:!1,checkAll:e.target.checked})},onChange:function(e){this.indeterminate=!!e.length&&e.length<this.SystemTables.length,this.checkAll=e.length===this.SystemTables.length},BackUp:function(){var e=this;if(0!=this.GetTables.length){var t={tables:this.GetTables};this.messageShowLoad=!0,c(t).then((function(t){0==t.data.code?e.$message.success(e.$t("DbBack.BackupsSuccess")):e.$message.error(e.$t("DbBack.BackupsFailed"))})).finally((function(t){e.messageShowLoad=!1}))}else e.$message.error(e.$t("DbBack.BackupsTips"))},GetDbConfig:function(){var e=this,t={};this.messageShowLoad=!0,f(t).then((function(t){0==t.data.code&&(e.DbConfig=t.data.config,e.DbType=e.DbConfig.DbType,e.form.setFieldsValue({DbType:e.DbConfig.DbType.toString()}),0==e.DbType?setTimeout((function(){e.form.setFieldsValue({DbUserName:e.DbConfig.Mysqluser.toString(),DbPassword:e.DbConfig.Mysqlpwd.toString(),DbServer:e.DbConfig.Mysqlhost.toString(),DbServerPort:e.DbConfig.Mysqlport.toString(),DbName:e.DbConfig.Mysqldbname.toString()}),e.messageShowLoad=!1}),1e3):e.messageShowLoad=!1)})).catch((function(t){e.messageShowLoad=!1}))},SetDbConfig:function(){var e=this,t=this;this.form.validateFields((function(a){if(!a){var i={DbType:parseInt(e.form.getFieldValue("DbType"))};0==i.DbType&&(i.Mysqluser=e.form.getFieldValue("DbUserName"),i.Mysqlpwd=e.form.getFieldValue("DbPassword"),i.Mysqlhost=e.form.getFieldValue("DbServer"),i.Mysqlport=e.form.getFieldValue("DbServerPort"),i.Mysqldbname=e.form.getFieldValue("DbName")),e.Configuring=!0,D(i).then((function(e){0==e.data.code?(t.$message.success(t.$t("DbBack.ConfigureSuccess")),t.$router.push("/login")):-3==e.data.code?t.$message.error(t.$t("DbBack.DbConnectError")):t.$message.error(t.$t("DbBack.ConfigureFailed"))})).finally((function(e){t.Configuring=!1}))}}))},callback:function(e){"2"==e?this.GetBackUpList():"1"==e?this.GetTablesList():"3"==e&&this.GetDbConfig()},GetTablesList:function(){var e=this;this.messageShowLoad=!0,e.SystemTables=[],u().then((function(t){if(null==t.data.code){for(var a=0;a<t.data.list.length;a++)""!=t.data.list[a]&&e.SystemTables.push(t.data.list[a]);e.GetTables=e.SystemTables,e.checkAll=!0}})).finally((function(t){e.messageShowLoad=!1}))},GetBackUpList:function(){var e=this;this.messageShowLoad=!0,e.BackupList=[],m().then((function(t){0==t.data.code&&(e.BackupList=t.data.list)})).finally((function(t){e.messageShowLoad=!1}))},DbRestore:function(e){var t=this;this.messageShowLoad=!0;var a={DbFilePath:e};b(a).then((function(e){0==e.data.code?(t.$message.success(t.$t("DbBack.RestoreSuccess")),t.$router.push("/login")):t.$message.error(t.$t("DbBack.RestoreFailed"))})).finally((function(e){t.messageShowLoad=!1}))}},watch:{}},k=v,S=(a("0578"),a("2877")),$=Object(S["a"])(k,i,n,!1,null,"13db3505",null);t["default"]=$.exports},6959:function(e,t,a){"use strict";a("d1f9")},"6a11":function(e,t,a){},a164:function(e,t,a){},a2eb:function(e,t,a){"use strict";a("a164")},d1f9:function(e,t,a){}}]);